---
title: "Class 11: Structural Bioinformatics 1"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## The PDB database for biomolecular structure data

> Q1. determine the percentage of structures solved by X-Ray and Electron Microscopy.

> determine what proportion of structures are protein?

Download CSV file from PDB website ("Analyze" -> "PDB Statistics" > "by Experimental Method and Molecular Type")
```{r}
# Read CSV
data <- read.csv("Data Export Summary.csv", row.names = 1)
View(data)
```
Total number of entries
```{r}
sum(data$Total)
```

Proportion of entries from each method
```{r}
round((data$Total/sum(data$Total)) * 100, 2)
```

Proportion that are protein
```{r}
round(sum(data$Proteins)/sum(data$Total) * 100, 2)
```

## Introduction to Bio3D in R

Here we will read the 1HSG PDB structure and select the protein component and write out a new **protein-only** PDB format file. We then do the same for the ligand (i.e. know drug molecule) creating a **ligand-only** PDB file.

### Getting started with Bio3D
```{r}
library(bio3d)
```

### Bio3D functions and their typical usage
```{r}
example("plot.bio3d")
```

### Working with indivisual PDB files

read and inspect the on-line file with PDB ID 4q21:
```{r}
pdb <- read.pdb("1hsg")
```

To get a quick summary of the contents of the pdb object you just created you can issue the command print(pdb) or simply type pdb (which is equivalent in this case):
```{r}
pdb
```

> Q6. How many amino acid residues are there in this pdb object and what are the two nonprotein residues?

> Protein Atoms#: 1514  (residues/Calpha atoms#: 198)
> Non-protein/nucleic resid values: [ HOH (127), MK1 (1) ]

Note that the attributes (+ attr:) of this object are listed on the last couple of lines. To find the attributes of any such object you can use:

```{r}
attributes(pdb)
```


```{r}
atom.select(pdb, "protein", value = TRUE)
```

```{r}
ligand <- atom.select(pdb, "ligand", value = TRUE)
write.pdb(ligand, file = "ihsg_ligand.pdb")
```

